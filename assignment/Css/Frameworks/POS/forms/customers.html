<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!--  <link rel="stylesheet" href="../../../../../assets/fonts/fontawesome-free-6.1.2-web/css/all.min.css">-->
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;800&family=Public+Sans:wght@600&family=Raleway:wght@500;600;700;800;900&display=swap"
        rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <style>
    body {
      background-color: #8FC3BA;
      height: 100vh;
    }

    * {
      font-family: 'Poppins', Sans-serif;
      font-style: normal;
      font-weight: 600;

    }

    main > h1 {
      font-family: 'Mukta Mahee';
      font-style: normal;
      font-weight: 600;
      font-size: 43px;
    }
  </style>
</head>
<body>


<main class="container mt-5">
  <div class="position-absolute ">
    <button class="btn btn-primary bg-transparent border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions"><i class="fa-solid fa-bars text-dark " style="font-size:30px;"></i></button>
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions" aria-labelledby="offcanvasWithBothOptionsLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link "  href="../index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="customers.html">Customers</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="items.html">Items</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="orders.html">Order</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <h1 class="ms-5 position-relative" style="bottom: 3px; left: 10px;"><u>CUSTOMERS</u></h1>
  <section class="row">
    <div class="col-sm-12 col-4 col-lg-5 mt-5 col-xl-4">
      <h4 class="rounded-3 p-2 bg-opacity-25 bg-success"
          style="  border: 1px solid black;">Search Customer</h4>

      <div class=" col-7 mt-4 mb-3 ">
        <select class="form-select bg-transparent " aria-label="Default select example">
          <option selected class="col-8">Select Name/NIC/Code</option>
          <option value="1">Name</option>
          <option value="2">NIC</option>
          <option value="3">Code</option>
        </select>
      </div>

      <div class="form-floating input-group mt-1 mb-3 col-10">
        <input type="email" class="form-control bg-transparent" id="floatingInput" placeholder="200072501233">
        <label for="floatingInput">Customer Name/NIC/Code</label>
        <button class="btn btn-outline-secondary text-dark bg-opacity-75" type="button" id="button-addon2"
                style="background-color: #905FCAC7">Search
        </button>
      </div>
      <button type="button" class="btn btn-danger  me-2" id="btnDelete">Delete</button>
      <button type="button" class="btn btn-warning me-2" id="btnUpdate">Update</button>
      <button type="button" class="btn btn-success me-2" id="btnClear">Clear</button>
    </div>

    <div class="row col-sm-12 col-6 col-lg-6 col-xl-6">

      <div class="col-6 position-relative " style="top:40px; left: 480px;">
        <h5>Customer Code</h5>
        <h6 class="text-muted">C00-001</h6>

        <h5>Customer Name</h5>
        <h6 class="text-muted">Hiruni Piumika</h6>

        <h5>Customer NIC</h5>
        <h6 class="text-muted">200072501233</h6>

        <h5>Customer DOB</h5>
        <h6 class="text-muted">2000/08/12</h6>

        <h5>Customer Address</h5>
        <h6 class="text-muted">Weligama</h6>

        <h5>Customer Salary</h5>
        <h6 class="text-muted">25000</h6>
      </div>
    </div>

    <div class="col-sm-5 col-2 col-xl-2">
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-dark col-sm-12" data-bs-toggle="modal" data-bs-target="#exampleModal">+ Add Customer</button>

      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Add Customer</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <section class="container">
                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="customerCode" placeholder="C00-001">
                  <label for="customerCode">Customer Code</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="customerName" placeholder="Hiruni Piumika">
                  <label for="customerName">Customer Name</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="customerNIC" placeholder="200072501233">
                  <label for="customerNIC">Customer NIC</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="date" class="form-control" id="customerDOB" placeholder="Hiruni Piumika">
                  <label for="customerDOB">Customer DOB</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="customerAddress" placeholder="Weligama">
                  <label for="customerAddress">Customer Address</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="customerSalary" placeholder="25000">
                  <label for="customerSalary">Customer Salary</label>
                </div>
              </section>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-success" id="saveCus">Save Customer</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <section class="row mt-sm-2 ">
    <div class="col-12   text-sm-end text-lg-end ">
      <button type="button" class="btn btn-primary text-sm-end " id="viewAllCus">View All Customers</button>
    </div>
    <div class="col-12 mt-5">
      <table class="table mt-3 table-hover">
        <thead class="" style="border-radius: 10px; background: rgba(55, 38, 39, 0.31)">
        <tr>
          <th scope="col"></th>
          <th scope="col">Customer Code</th>
          <th scope="col">Customer Name</th>
          <th scope="col">Customer NIC</th>
          <th scope="col">Customer DOB</th>
          <th scope="col">Customer Address</th>
          <th scope="col">Customer Salary</th>
        </tr>
        </thead>
        <tbody id="CusTbody">
        <tr>
          <th scope="row">1</th>
          <td>C00-001</td>
          <td>Hiruni </td>
          <td>200072501233</td>
          <td>2000/08/12</td>
          <td>Weligama</td>
          <td>25000</td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>C00-002</td>
          <td>Chathu</td>
          <td>199912354367</td>
          <td>1999/09/16</td>
          <td>Kananke</td>
          <td>29000</td>
        </tr>
        </tbody>
      </table>
    </div>
  </section>
</main>
<script src="../assets/js/bootstrap.min.js"></script>
<!--<script src="/assignment/js/SPA/assest/jQuery/jquery-3.6.1.min.js"></script>-->
<script>
        //save customer//
         var customerArray=[]

         function saveCustomer(){
           // var customerObject ={CustomerCode,CustomerName,CustomerNIC,CustomerDOB,CustomerAddress,CustomerSalary}
             let CusCode=$("#customerCode").val()
             let CusName=$("#customerName").val()
             let CusNic=$("#customerNIC").val()
             let CusDob=$("#customerDOB").val()
             let CusAdd=$("#customerAddress").val()
             let CusSalary=$("#customerSalary").val()

             var customerObject ={CusCode,CusName,CusNic,CusDob,CusAdd,CusSalary}

             customerArray.push(customerObject)
             console.log(customerArray)

         }

      $("#saveCus").click(function (){
        alert("Customer Saved")
        saveCustomer()
        loadCustomer()
        bindRowClickEvents()
      })
       //load customer//
      function loadCustomer(){
        for(var i of customerArray){
          var raw=`<tr><th></th><td>${i.CusCode}</td><td>${i.CusName}</td><td>${i.CusNic}</td><td>${i.CusDob}</td><td>${i.CusAdd}</td><td>${i.CusSalary}</td></tr>`
          $("#CusTbody").append(raw)
        }
      }

        $("#viewAllCus").click(function () {
          loadCustomer();
        });

        //table row val select
        function bindRowClickEvents() {
          $("#CusTbody>tr").click(function () {
            let code = $(this).children(":eq(0)").text();
            let name = $(this).children(":eq(1)").text();
            let nic = $(this).children(":eq(2)").text();
            let dob = $(this).children(":eq(3)").text();
            let address = $(this).children(":eq(4)").text();
            let salary = $(this).children(":eq(5)").text();

            $('#customerCode').val(code);
            $('#customerName').val(name);
            $('#customerNIC').val(nic);
            $('#customerDOB').val(dob);
            $('#customerAddress').val(address);
            $('#customerSalary').val(salary);

          });
        }

        //clear inputField
        function clear(){
          $('#customerCode').val('')
          $('#customerName').val('')
          $('#customerNIC').val('')
          $('#customerDOB').val('')
          $('#customerAddress').val('')
          $('#customerSalary').val('')
        }

        //search customer
        $("#customerCode").on('keyup', function (event) {
          if (event.code == "Enter") {
            let typedId = $("#customerCode").val();
            let customer = searchCustomer(typedId);
            if (customer != null) {
              setTestifiedValues(customer.cusCode, customer.cusName, customer.cusNic, customer.cusDob,customer.cusAddress,customer.cusSalary);
            } else {
              alert("There is no customer available for that " + typedId);
              setTestifiedValues("", "", "", "","","");
            }
          }
        });

        function searchCustomer(cusCode) {
          for (let customer of customerArray) {
            if (customer.code == cusCode) {
              return customer;
            }
          }
          return null;
        }

        function setTestifiedValues(code, name, nic, dob,address,salary) {
          $("#customerCode").val(code);
          $("#customerName").val(name);
          $("#customerNIC").val(nic);
          $("#customerDOB").val(dob);
          $("#customerAddress").val(address);
          $("#customerSalary").val(salary);
        }

        //update customer
        $('#btnUpdate').click(function(){
          let customerCode=$('#customerCode').val()
          let response=updateCustomer(customerCode)
          if(response){
            Swal.fire({
              title: 'Customer Updated Successfully',
            })
            $('#customerCode').val('')
            $('#customerName').val('')
            $('#customerNIC').val('')
            $('#customerDOB').val('')
            $('#customerAddress').val('')
            $('#customerSalary').val('')
          }
          else{
            Swal.fire("Update Failed" )
          }
        })

        function updateCustomer(cusCode) {
          let customer = searchCustomer(cusCode);
          if (customer != null) {
            customer.cusCode = $("#customerCode").val();
            customer.cusName = $("#customerName").val();
            customer.cusNic = $("#customerNIC").val();
            customer.cusDob = $("#customerDOB").val();
            customer.cusAddress = $("#customerAddress").val();
            customer.cusSalary = $("#customerSalary").val();
            loadCustomer();
            clear()
            setTestifiedValues()
            return true;
          } else {
            return false;
          }

        }

        //remove customer
        function deleteCustomer(customerID) {
          let customer = searchCustomer(customerID);
          if (customer != null) {
            let indexNumber = customerArray.indexOf(customer);
            customerArray.splice(indexNumber, 1);
            loadCustomer();
            return true;
          } else {
            return false;
          }
        }

        $("#btnDelete").click(function () {
          let deleteCode = $("#customerCode").val();

          let del = confirm("Do you really want to delete customer id :" + deleteCode);
          if (del){
            if (deleteCustomer(deleteCode)) {
              setTestifiedValues("", "", "", "");
            } else {
              alert("No such customer to delete. please check the id");
            }
          }
        });
</script>
</body>
</html>